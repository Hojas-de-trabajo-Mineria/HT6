<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HT7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HT6_files/libs/clipboard/clipboard.min.js"></script>
<script src="HT6_files/libs/quarto-html/quarto.js"></script>
<script src="HT6_files/libs/quarto-html/popper.min.js"></script>
<script src="HT6_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HT6_files/libs/quarto-html/anchor.min.js"></script>
<link href="HT6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HT6_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HT6_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HT6_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HT6_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HT7</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="hoja-de-trabajo-7" class="level1">
<h1>Hoja de Trabajo 7</h1>
<section id="modificación-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="modificación-de-los-datos">Modificación de los datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(pricesTrain))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Id    MSSubClass      MSZoning   LotFrontage       LotArea 
            0             0             0           259             0 
       Street         Alley      LotShape   LandContour     Utilities 
            0          1369             0             0             0 
    LotConfig     LandSlope  Neighborhood    Condition1    Condition2 
            0             0             0             0             0 
     BldgType    HouseStyle   OverallQual   OverallCond     YearBuilt 
            0             0             0             0             0 
 YearRemodAdd     RoofStyle      RoofMatl   Exterior1st   Exterior2nd 
            0             0             0             0             0 
   MasVnrType    MasVnrArea     ExterQual     ExterCond    Foundation 
            8             8             0             0             0 
     BsmtQual      BsmtCond  BsmtExposure  BsmtFinType1    BsmtFinSF1 
           37            37            38            37             0 
 BsmtFinType2    BsmtFinSF2     BsmtUnfSF   TotalBsmtSF       Heating 
           38             0             0             0             0 
    HeatingQC    CentralAir    Electrical     X1stFlrSF     X2ndFlrSF 
            0             0             1             0             0 
 LowQualFinSF     GrLivArea  BsmtFullBath  BsmtHalfBath      FullBath 
            0             0             0             0             0 
     HalfBath  BedroomAbvGr  KitchenAbvGr   KitchenQual  TotRmsAbvGrd 
            0             0             0             0             0 
   Functional    Fireplaces   FireplaceQu    GarageType   GarageYrBlt 
            0             0           690            81            81 
 GarageFinish    GarageCars    GarageArea    GarageQual    GarageCond 
           81             0             0            81            81 
   PavedDrive    WoodDeckSF   OpenPorchSF EnclosedPorch    X3SsnPorch 
            0             0             0             0             0 
  ScreenPorch      PoolArea        PoolQC         Fence   MiscFeature 
            0             0          1453          1179          1406 
      MiscVal        MoSold        YrSold      SaleType SaleCondition 
            0             0             0             0             0 
    SalePrice 
            0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> pricesTrain[<span class="fu">order</span>(pricesTrain<span class="sc">$</span>SalePrice),]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>orderPrice[<span class="st">'Clasificacion'</span>]<span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(orderPrice))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Id, MoSold, YrSold, GarageYrBlt, Alley, LotShape, LandContour, Condition2, YearBuilt, Exterior2nd, FireplaceQu, GarageQual, SaleType,BsmtFinType2, BsmtFinSF2, BsmtUnfSF, BsmtFullBath, BsmtHalfBath, X3SsnPorch, GarageFinish, YearRemodAdd, PoolQC, Fence, MiscFeature))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span> (<span class="fu">c</span>(<span class="st">"MSSubClass"</span>,<span class="st">"MSZoning"</span>, <span class="st">"Utilities"</span>, <span class="st">"LotConfig"</span>, <span class="st">"Street"</span>, <span class="st">"LandSlope"</span>, <span class="st">"Neighborhood"</span>, <span class="st">"Condition1"</span>, <span class="st">"BldgType"</span>, <span class="st">"HouseStyle"</span>, <span class="st">"OverallQual"</span>, <span class="st">"OverallCond"</span>, <span class="st">"RoofStyle"</span>, <span class="st">"PavedDrive"</span>, <span class="st">"RoofMatl"</span>, <span class="st">"Exterior1st"</span>, <span class="st">"MasVnrType"</span>, <span class="st">"ExterQual"</span>, <span class="st">"ExterCond"</span>,<span class="st">"Foundation"</span>, <span class="st">"BsmtQual"</span>, <span class="st">"BsmtCond"</span>, <span class="st">"BsmtExposure"</span>, <span class="st">"BsmtFinType1"</span>, <span class="st">"Heating"</span>, <span class="st">"HeatingQC"</span>, <span class="st">"CentralAir"</span>,<span class="st">"Electrical"</span>, <span class="st">"Functional"</span>, <span class="st">"GarageType"</span>, <span class="st">"GarageCond"</span>, <span class="st">"SaleCondition"</span>, <span class="st">"KitchenQual"</span>), as.factor)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>), as.numeric)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&lt;=</span> <span class="dv">139000</span>] <span class="ot">&lt;-</span> <span class="st">'Economica'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&gt;</span> <span class="dv">139000</span> <span class="sc">&amp;</span> orderPrice<span class="sc">$</span>SalePrice <span class="sc">&lt;=</span> <span class="dv">189893</span> ] <span class="ot">&lt;-</span> <span class="st">'Intermedia'</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&gt;</span> <span class="dv">189893</span>] <span class="ot">&lt;-</span> <span class="st">'Cara'</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>), scale)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fueron retiradas las variables que no tienen relación con la variable respuesta, así como aquellas con altas cantidades de NA’s. Todas las variables categóricas fueron convertidas en factores y las numéricas fueron normalizadas. Además, fue agregada una variable categórica que representa el rango de precio en el que se encuentra cada una de las casas, esta es nuestra variable de interés.</p>
</section>
<section id="muestreo" class="level2">
<h2 class="anchored" data-anchor-id="muestreo">Muestreo</h2>
<p>Muestreo estratificado</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COnvertir en factores</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice<span class="sc">%&gt;%</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"Clasificacion"</span>),as.factor)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>economicas <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Economica'</span>,]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>intermedias <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Intermedia'</span>,]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>caras <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Cara'</span>,]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>filasCasasE <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(economicas), <span class="fu">nrow</span>(economicas)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>filasCasasI <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(intermedias), <span class="fu">nrow</span>(intermedias)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>filasCasasC <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(caras), <span class="fu">nrow</span>(caras)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">rbind</span>(economicas[filasCasasE,], intermedias[filasCasasI,], caras[filasCasasC,])</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">rbind</span>(economicas[<span class="sc">-</span>filasCasasE,], intermedias[<span class="sc">-</span>filasCasasI,], caras[<span class="sc">-</span>filasCasasC,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generación-de-los-modelos" class="level2">
<h2 class="anchored" data-anchor-id="generación-de-los-modelos">Generación de los modelos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>modeloSVM_1<span class="ot">&lt;-</span><span class="fu">svm</span>(Clasificacion<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">cost=</span><span class="dv">2</span><span class="sc">^-</span><span class="dv">5</span>, <span class="at">kernel=</span><span class="st">"linear"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>modeloSVM_2<span class="ot">&lt;-</span><span class="fu">svm</span>(Clasificacion<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">cost=</span><span class="fl">0.5</span>, <span class="at">kernel=</span><span class="st">"polynomial"</span>, <span class="at">degree =</span> <span class="dv">4</span>, <span class="at">coef =</span> <span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>modeloSVM_3<span class="ot">&lt;-</span><span class="fu">svm</span>(Clasificacion<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">gamma=</span><span class="dv">2</span><span class="sc">^-</span><span class="dv">5</span>, <span class="at">kernel=</span><span class="st">"radial"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>modeloSVM_4<span class="ot">&lt;-</span><span class="fu">svm</span>(Clasificacion<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">gamma=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">1</span>, <span class="at">kernel=</span><span class="st">"radial"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>modeloSVM_1<span class="sc">$</span>fitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       699       1250        891        433        556        558       1276 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
      1422        354       1131        802        916        264         39 
Intermedia  Economica  Economica  Economica  Economica  Economica  Economica 
       275        987       1249         27        587       1293        374 
 Economica  Economica Intermedia  Economica  Economica  Economica  Economica 
       500        243         50        838        449        425        780 
 Economica  Economica  Economica  Economica  Economica Intermedia  Economica 
      1341        446       1073        588       1392        659        726 
 Economica Intermedia  Economica  Economica  Economica  Economica  Economica 
       836       1064       1002        384        888        391        631 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       146         98        411        495       1184       1105         80 
Intermedia  Economica  Economica  Economica Intermedia  Economica  Economica 
      1398        236        672        108        155        664       1063 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       813        345        312       1400        440       1346       1011 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       552        490         30        457        913        980        381 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       720        439       1405        694        438         20        506 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
      1151        111         53        195       1379       1115       1095 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       575       1035        203       1187        798        712        580 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       772        952        426        885        810        868        789 
 Economica  Economica Intermedia  Economica  Economica  Economica  Economica 
       180        451       1224        677       1118        862        864 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
        99         75       1368       1071         84        761       1286 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       590        332        618         31        244        499       1232 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       358       1390        670        324       1040       1262        397 
Intermedia  Economica  Economica  Economica  Economica  Economica  Economica 
      1378       1433        423       1026        900        762        873 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
        10        595        572        807        326        946         92 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       216       1101        932        274       1353       1029        729 
 Economica  Economica  Economica Intermedia  Economica  Economica Intermedia 
      1320        549       1337        953       1201        593        205 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
      1315        917        871        698        396        877        527 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
      1133       1080         72        774       1093        629        714 
 Economica  Economica  Economica  Economica Intermedia Intermedia  Economica 
      1070        428       1203        342        414       1145        787 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
      1446        532        936       1230       1114       1177       1388 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       151       1407        973        514       1163        510        633 
 Economica  Economica  Economica Intermedia  Economica  Economica Intermedia 
       897        218       1062        226       1296       1120       1023 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       585       1121        476       1335       1308        724       1393 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       188       1008         16        437         78        293        431 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
      1216        999       1089       1103       1340        730        979 
 Economica  Economica Intermedia  Economica  Economica  Economica  Economica 
        69       1015       1082       1332       1429        395         94 
 Economica  Economica  Economica  Economica  Economica  Economica  Economica 
       610         60        480        145         62       1213        957 
 Economica  Economica  Economica  Economica  Economica  Economica Intermedia 
       623        122       1030       1371       1328        566        330 
 Economica  Economica  Economica  Economica Intermedia  Economica  Economica 
       247        602        970        124         42        116        296 
 Economica Intermedia  Economica Intermedia Intermedia Intermedia Intermedia 
      1330        736        967       1426        212       1265        992 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
       468        286       1077        591        709        630        368 
Intermedia Intermedia Intermedia       Cara Intermedia Intermedia Intermedia 
       755        223        253       1160        503       1053        696 
Intermedia Intermedia Intermedia Intermedia  Economica Intermedia Intermedia 
       420        328       1361        261        498         33        483 
 Economica Intermedia Intermedia Intermedia Intermedia       Cara Intermedia 
       944        300        915        859        268       1372        947 
 Economica Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
       675       1051        959        704        511        214       1321 
Intermedia Intermedia       Cara Intermedia Intermedia Intermedia Intermedia 
       505       1171       1300        850       1205        858        920 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
       524       1104        290        571        994        782        743 
      Cara Intermedia  Economica  Economica Intermedia Intermedia Intermedia 
      1336       1274        315       1459         82        648        464 
Intermedia Intermedia Intermedia  Economica Intermedia Intermedia Intermedia 
       676        776        660        837        745        831        923 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
      1243       1157        248        136        892        649        522 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
        22        377       1453        135        531        809        682 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia  Economica 
       443        824       1161        903        102       1054        220 
 Economica  Economica Intermedia Intermedia Intermedia Intermedia Intermedia 
      1172        430       1056       1100        201        756       1148 
Intermedia Intermedia Intermedia Intermedia  Economica Intermedia Intermedia 
      1198        803       1356        681        120        133        493 
 Economica       Cara Intermedia  Economica Intermedia Intermedia Intermedia 
       821       1135        210       1439       1209        486       1168 
      Cara Intermedia Intermedia Intermedia  Economica Intermedia Intermedia 
       589        828       1005        557        778        278        732 
Intermedia       Cara       Cara  Economica  Economica  Economica Intermedia 
       301         57       1383        628       1119        607        189 
Intermedia Intermedia Intermedia Intermedia  Economica Intermedia Intermedia 
        87        604        417        881        255       1140        346 
Intermedia Intermedia Intermedia Intermedia  Economica  Economica  Economica 
       535        263         45        718         93       1079        444 
Intermedia Intermedia  Economica Intermedia Intermedia Intermedia Intermedia 
       845       1299        797        626        380       1200        832 
Intermedia       Cara Intermedia Intermedia Intermedia Intermedia Intermedia 
       299        316       1294        366        644        842         61 
Intermedia Intermedia Intermedia  Economica Intermedia Intermedia Intermedia 
      1237        138        671        791        455        972        625 
Intermedia Intermedia       Cara Intermedia  Economica Intermedia Intermedia 
      1199       1006        717        484        202        702       1196 
      Cara Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
        74        635        559       1150        600       1394        579 
Intermedia  Economica Intermedia Intermedia Intermedia Intermedia Intermedia 
      1436        975       1365       1298        759         88        287 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
       835        983        470        282        911       1152       1239 
Intermedia Intermedia Intermedia Intermedia  Economica Intermedia Intermedia 
        37        783        509        830        893        254       1084 
Intermedia       Cara Intermedia Intermedia  Economica Intermedia Intermedia 
       355          4       1067        855        562       1364       1068 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
       356        960        993       1185        819       1282        143 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia  Economica 
      1127       1013        207        285        169        963       1264 
Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia Intermedia 
      1226         41        853       1260       1211        487         38 
Intermedia Intermedia Intermedia Intermedia       Cara Intermedia Intermedia 
       526       1081        882       1416        206       1195       1027 
      Cara Intermedia       Cara       Cara Intermedia Intermedia Intermedia 
       129        695        295       1285       1086        249        523 
Intermedia  Economica Intermedia Intermedia Intermedia       Cara Intermedia 
       966        586        390        259        445         86       1153 
Intermedia       Cara       Cara       Cara       Cara       Cara       Cara 
       705        804       1404       1188       1441        131        115 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       550         70        277        728       1112        948       1159 
      Cara       Cara       Cara       Cara Intermedia       Cara       Cara 
      1410        163        232        246       1028        173       1443 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       668        725        899         58       1206        314        139 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
         3        703       1303        190        507        447        982 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       113        375       1083        582        441        262        808 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       569        213       1170        119       1440        334        927 
      Cara       Cara       Cara       Cara Intermedia       Cara       Cara 
        71       1076        482        404        338        502         68 
      Cara Intermedia       Cara       Cara       Cara       Cara       Cara 
      1052        322        142         23       1339       1331        479 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       568        284        679        415        555       1176        177 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
        48        477       1156         54        935       1116        601 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       176        766        193        198        504        950        640 
      Cara       Cara       Cara       Cara       Cara Intermedia       Cara 
        97       1438         21        641        749       1128        825 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
      1122         29       1066       1158        337        525       1003 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
        35        279        865         46        547        409        645 
      Cara       Cara       Cara       Cara Intermedia       Cara       Cara 
       256       1406       1387        319       1268        305       1061 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       272        429        191       1289       1059        731        769 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
      1143         26       1183        335        849        833       1202 
      Cara       Cara       Cara Intermedia       Cara       Cara       Cara 
       379       1043        763         28       1044        339        826 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       753        184        609        454        619        528        341 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       919        280        481        876        323        632        436 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       567         63       1167        302        452        276        461 
      Cara       Cara       Cara       Cara       Cara Intermedia       Cara 
       298        230       1304       1238         36        765       1375 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       197        469        733       1281        740       1316       1290 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
      1452        239        327        424        478       1000        620 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
      1075       1189       1242        687       1110       1047        386 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
         5         81        991        965        692       1208       1022 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       777       1389        924        738          7       1020        608 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
      1391        806        931       1134        938        158       1307 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
      1108        333       1411        543       1314        788        816 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       665       1229         83         95       1257         12        306 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       708        227        518       1354       1402       1169       1017 
      Cara       Cara       Cara       Cara Intermedia       Cara       Cara 
       252       1175       1323        794        605       1129        606 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       934       1259       1106        988        700        508        693 
      Cara Intermedia       Cara       Cara       Cara       Cara       Cara 
        47       1251       1318        392        764        598        291 
      Cara       Cara       Cara       Cara       Cara Intermedia       Cara 
       925       1351        754        410        907        684        144 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       321        258        474        757        140       1009        303 
      Cara       Cara       Cara       Cara       Cara       Cara       Cara 
       889        933        152        182       1457        964        281 
      Cara       Cara       Cara Intermedia       Cara       Cara       Cara 
       378       1395        847        573       1311 
      Cara       Cara       Cara       Cara       Cara 
Levels: Cara Economica Intermedia</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modeloSVM_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = Clasificacion ~ ., data = train, cost = 2^-5, kernel = "linear")


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  0.03125 

Number of Support Vectors:  397

 ( 106 194 97 )


Number of Classes:  3 

Levels: 
 Cara Economica Intermedia</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modeloSVM_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = Clasificacion ~ ., data = train, cost = 0.5, kernel = "polynomial", 
    degree = 4, coef = 1)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  polynomial 
       cost:  0.5 
     degree:  4 
     coef.0:  1 

Number of Support Vectors:  443

 ( 120 219 104 )


Number of Classes:  3 

Levels: 
 Cara Economica Intermedia</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modeloSVM_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = Clasificacion ~ ., data = train, gamma = 2^-5, kernel = "radial")


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  radial 
       cost:  1 

Number of Support Vectors:  484

 ( 141 223 120 )


Number of Classes:  3 

Levels: 
 Cara Economica Intermedia</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modeloSVM_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = Clasificacion ~ ., data = train, gamma = 2^1, kernel = "radial")


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  radial 
       cost:  1 

Number of Support Vectors:  761

 ( 239 245 277 )


Number of Classes:  3 

Levels: 
 Cara Economica Intermedia</code></pre>
</div>
</div>
</section>
<section id="predicciones" class="level2">
<h2 class="anchored" data-anchor-id="predicciones">Predicciones</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>prediccion1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modeloSVM_1, <span class="at">newdata =</span> test[,<span class="sc">-</span><span class="dv">58</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>prediccion2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modeloSVM_2, <span class="at">newdata =</span> test[,<span class="sc">-</span><span class="dv">58</span>])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>prediccion3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modeloSVM_3, <span class="at">newdata =</span> test[,<span class="sc">-</span><span class="dv">58</span>])</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>prediccion4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modeloSVM_4, <span class="at">newdata =</span> test[,<span class="sc">-</span><span class="dv">58</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="matrices-de-confusión" class="level2">
<h2 class="anchored" data-anchor-id="matrices-de-confusión">Matrices de confusión</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(test[<span class="fu">complete.cases</span>(test), <span class="dv">58</span>], prediccion1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        112         0          7
  Economica     0        92         11
  Intermedia    9        23         80

Overall Statistics
                                          
               Accuracy : 0.8503          
                 95% CI : (0.8074, 0.8868)
    No Information Rate : 0.3623          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7753          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.9256           0.8000            0.8163
Specificity               0.9671           0.9498            0.8644
Pos Pred Value            0.9412           0.8932            0.7143
Neg Pred Value            0.9581           0.9004            0.9189
Prevalence                0.3623           0.3443            0.2934
Detection Rate            0.3353           0.2754            0.2395
Detection Prevalence      0.3563           0.3084            0.3353
Balanced Accuracy         0.9464           0.8749            0.8404</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(test[<span class="fu">complete.cases</span>(test), <span class="dv">58</span>], prediccion2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        112         0          7
  Economica     0        91         12
  Intermedia   11        22         79

Overall Statistics
                                          
               Accuracy : 0.8443          
                 95% CI : (0.8009, 0.8815)
    No Information Rate : 0.3683          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7663          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.9106           0.8053            0.8061
Specificity               0.9668           0.9457            0.8602
Pos Pred Value            0.9412           0.8835            0.7054
Neg Pred Value            0.9488           0.9048            0.9144
Prevalence                0.3683           0.3383            0.2934
Detection Rate            0.3353           0.2725            0.2365
Detection Prevalence      0.3563           0.3084            0.3353
Balanced Accuracy         0.9387           0.8755            0.8331</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(test[<span class="fu">complete.cases</span>(test), <span class="dv">58</span>], prediccion3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        106         0         13
  Economica     0        91         12
  Intermedia    9        24         79

Overall Statistics
                                          
               Accuracy : 0.8263          
                 95% CI : (0.7814, 0.8654)
    No Information Rate : 0.3443          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7395          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.9217           0.7913            0.7596
Specificity               0.9406           0.9452            0.8565
Pos Pred Value            0.8908           0.8835            0.7054
Neg Pred Value            0.9581           0.8961            0.8874
Prevalence                0.3443           0.3443            0.3114
Detection Rate            0.3174           0.2725            0.2365
Detection Prevalence      0.3563           0.3084            0.3353
Balanced Accuracy         0.9312           0.8683            0.8081</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(test[<span class="fu">complete.cases</span>(test), <span class="dv">58</span>], prediccion4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        119         0          0
  Economica   102         1          0
  Intermedia  112         0          0

Overall Statistics
                                          
               Accuracy : 0.3593          
                 95% CI : (0.3078, 0.4133)
    No Information Rate : 0.997           
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.0049          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity             0.357357         1.000000                NA
Specificity             1.000000         0.693694            0.6647
Pos Pred Value          1.000000         0.009709                NA
Neg Pred Value          0.004651         1.000000                NA
Prevalence              0.997006         0.002994            0.0000
Detection Rate          0.356287         0.002994            0.0000
Detection Prevalence    0.356287         0.308383            0.3353
Balanced Accuracy       0.678679         0.846847                NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gr[afica predicción 1</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ytest <span class="ot">&lt;-</span> test[<span class="fu">complete.cases</span>(test), <span class="dv">58</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prediccion1 , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ytest, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT6_files/figure-html/conf_matrix-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfica predicción 2</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prediccion2 , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ytest, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT6_files/figure-html/conf_matrix-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfica predicción 3</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prediccion3 , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ytest, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT6_files/figure-html/conf_matrix-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfica predicción 4</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prediccion4 , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ytest, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT6_files/figure-html/conf_matrix-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Tomando en cuenta la exactitud de cada uno de los modelos anteriores, podemos concluir que los mejores fueron el modelo lineal y el polinomial, pues cada uno logró explicar más del 80% de la variabilidad. Sin embargo, como podemos apreciar en los resultados de las matrices, todos los modelos cuentan con algo de underfitting, con excepción del modelo 4, clasificando varias casas de las caras o económicas como intermedias. Consideramos que eso es lógico, ya que es el valor de en medio y el que más puede tener factores en común con los otros dos. Veamos en cambio como el modelo 4 tiene problemas de overfitting, como era de esperarse al colocar un c bastante elevado. Vemos entonces cómo clasificó a todas las casas como Caras, de modo que solo se ajusta al conjunto de entrenamiento. En este caso, en los primeros modelos se debría subir un poco el costo, sin embargo,m por el tipo de modelo, esto ayudaría más que todo en el modelo 3. En el caso del modelo 4 se debe realizar lo contrario</p>
</section>
<section id="comparación-con-modelos-anteriores" class="level2">
<h2 class="anchored" data-anchor-id="comparación-con-modelos-anteriores">Comparación con modelos anteriores</h2>
<p>Veamos que, a diferencia del modelo 4, el cual es el peor generado hasta la fecha, estos modelos son los que mejor porcentaje han tenido, y comparativamente se han equivocado en menos casas. En mejor modelo que teníamos anteriormente era uno realizado con RandomForest, el cual tenía un accuracy del 82.04%. Veamos que todos los modelos del 1-3 presentan un accuracy del 84% o superior, y vemos también en las matrices y gráficas que no se equivocaron mucho en la predicción de las casas</p>
</section>
<section id="modelo-de-regresión-con-svm" class="level2">
<h2 class="anchored" data-anchor-id="modelo-de-regresión-con-svm">Modelo de regresión con SVM</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>trainNum <span class="ot">&lt;-</span> train[, <span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>)]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>testNum <span class="ot">&lt;-</span> test[, <span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>)]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>msvmrt <span class="ot">&lt;-</span> <span class="fu">tune.svm</span>(SalePrice<span class="sc">~</span>., <span class="at">data =</span> trainNum, <span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">32</span>), <span class="at">kernel=</span><span class="st">"linear"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(msvmrt<span class="sc">$</span>best.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
best.svm(x = SalePrice ~ ., data = trainNum, cost = c(0.01, 0.1, 
    0.5, 1, 5, 10, 16, 20, 32), kernel = "linear")


Parameters:
   SVM-Type:  eps-regression 
 SVM-Kernel:  linear 
       cost:  0.01 
      gamma:  0.04 
    epsilon:  0.1 


Number of Support Vectors:  582</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>prediccionR <span class="ot">&lt;-</span> <span class="fu">predict</span>(msvmrt<span class="sc">$</span>best.model, <span class="at">newdata =</span> testNum[, <span class="sc">-</span><span class="dv">26</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comparación-con-otros-modelos" class="level3">
<h3 class="anchored" data-anchor-id="comparación-con-otros-modelos">Comparación con otros modelos</h3>
<p>En cuestión de tiempo, este fue el que tardó más tiempo en encontrar el mejor modelo, sin embargo, para predecir, este logró tener un porcentaje de predicción más elevado que los otros, sin embargo, debemos considerar las variable sutilizadas en cada modelo.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>